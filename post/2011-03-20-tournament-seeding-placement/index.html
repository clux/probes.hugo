<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Tournament Seeding Placement - probes</title><meta property=og:title content="Tournament Seeding Placement"><meta name=twitter:title content="Tournament Seeding Placement"><meta name=description content="Building elimination flows"><meta property=og:description content="Building elimination flows"><meta name=twitter:description content="Building elimination flows"><meta name=author content=clux><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"probes","url":"https://clux.github.io/probes/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https://clux.github.io/probes/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://clux.github.io/probes/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https://clux.github.io/probes/post/2011-03-20-tournament-seeding-placement/","name":"Tournament seeding placement"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"clux"},"headline":"Tournament Seeding Placement","description":"A particularly tricky problem with tournament scheduling that made it into tournament/duel.
","inLanguage":"en","wordCount":934,"datePublished":"2011-03-20T00:00:00","dateModified":"2011-03-20T00:00:00","image":"https://clux.github.io/probes/","keywords":["math"],"mainEntityOfPage":"https://clux.github.io/probes/post/2011-03-20-tournament-seeding-placement/","publisher":{"@type":"Organization","name":"https://clux.github.io/probes/","logo":{"@type":"ImageObject","url":"https://clux.github.io/probes/","height":60,"width":60}}}</script><meta property=og:title content="Tournament Seeding Placement"><meta property=og:description content="Building elimination flows"><meta property=og:url content=https://clux.github.io/post/2011-03-20-tournament-seeding-placement/><meta property=og:type content=website><meta property=og:site_name content=probes><meta name=twitter:title content="Tournament Seeding Placement"><meta name=twitter:description content="Building elimination flows"><meta name=twitter:card content=summary><meta name=twitter:site content=@sszynrae><meta name=twitter:creator content=@sszynrae><meta name=twitter:card content=summary><meta name=twitter:site content=@sszynrae><meta name=twitter:creator content=@sszynrae><meta property=og:url content=https://clux.github.io/post/2011-03-20-tournament-seeding-placement/><meta property=og:type content=website><meta property=og:site_name content=probes><meta name=generator content="Hugo 0.52"><link rel=alternate href=https://clux.github.io/probes/index.xml type=application/rss+xml title=probes><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://clux.github.io/probes/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://clux.github.io/probes/css/syntax.css><link rel=stylesheet href=https://clux.github.io/probes/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=https://clux.github.io/probes/>probes</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=Blog href=https://clux.github.io/probes/>Blog</a></li><li><a title=About href=https://clux.github.io/probes/page/about/>About</a></li><li><a title=Tags href=https://clux.github.io/probes/tags>Tags</a></li></ul></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>Tournament Seeding Placement</h1><h2 class=post-subheading>Building elimination flows</h2><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on March 20, 2011
&nbsp;(Last modified on December 9, 2018)
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;clux</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><p>A particularly tricky problem with tournament scheduling that made it into <a href=https://github.com/clux/duel>tournament/duel</a>.</p><p>This turned out to take a little more mental effort than initially expected and is documented herein for historical reasons.</p><p>The problem of how to order seeds into the tournament brackets seemed almost a bit random. But after some hours on the couch with pen and paper and <a href=http://beta.ivc.no/blog/>ivc</a> to talk to, we found a sensible solution.</p><h2 id=intro>Intro</h2><p><img src=https://clux.github.io/probes/imgs/seeding/blizzcon_single_duel_8p.jpg alt="System from BlizzCon (n=3)"></p><p>The seeding is the correspondence ${p \mid player} \leftrightarrow {1,2,\ldots,2^n}$ where the number $k(p)\in{1,2,\ldots,2^n}$ is the estimated ranking for player $p$, i.e. player $p$ is expected to beat player $q$ if and only if $k(p) &gt; k(q)$. The main problem is how to sort the players in the first round so that the the best players meet as late as possible (depending on their skill) in the tournament. The image below illustrates this for $2^3$ players. Formally we say:</p><h2 id=definitions>Definitions</h2><p>If there are $2^n$ players in the tournament then the ordering is <em>proper</em> if the following hold.</p><ul><li>If the seeding is perfect (perfectly predicts the match outcomes) then only the $2^{n+1-k}$ top seeded players are left in round $k$.</li><li>In each round the sum of the seeds in each match is constant.</li><li>The even seed in each match is placed at the bottom.</li></ul><p><img src=https://clux.github.io/probes/imgs/seeding/bracket8.gif alt="canonical n=3 bracket"></p><p>It&rsquo;s a bit much to assume that seedings are perfect, but the seeding above needs these three conditions to generate the analogous binary tree in $n$ dimensions, so we will use them. Besides, condition 2 does sort of provide some loose similar quality guarantee: the lower the sum, the most likely the better the games. The image above fills out what will happen in an eight player tournament if the seeding is perfect.</p><p>Knowing that it was these three properties that we wanted, we could at this point just generated the next level in the canonical tree successively until we got to the desired level to (i.e. make an arbitrarily large tournament system), but this would have been inefficient and a bit tedious (compared to finding patterns in numbers at paper, but that might be subjective). I tried first to find a system in the sequence ${(1),(1,2),(1,4,3,2),(1,8,5,4,3,6,7,2),\ldots}$, but this turned out to be very fruitless. Having ivc over, I explained the problem to him and we stared at it for a couple of hours (because that&rsquo;s just the kind of inviting friend I am).</p><p>Turns out the key was to look at the match numbers $1,\ldots,2^{n-1}$ by ordering from the top in the brackets. I.e. match 1 is 1 vs. 8, match 2 is 5 vs. 4 etc. The major clue here is that in a match number that is a power of two, the even numbered seed in that match is also a power of two. In fact match $2^k \mapsto 2^{n-k}$, so the hard part is interpolating this function for general match numbers.</p><p>The system becomes clear first when we look at a full 32 player tournament i.e. $n=5$. In the interests of fully testing out the $\LaTeX$, I would ideally write this out, but tables are a bit of a pain in TeX, and I have this paper anyway.</p><p><img src=https://clux.github.io/probes/imgs/seeding/32bracket.jpg alt="canonical n=5 bracket"></p><p>This is expanded uniquely using the three defined properties and the smaller bracket above. The match numbers in the first round are written on the left. Notice that the top players all follow diagonal paths when they reach vastly inferior players.</p><p><img src=https://clux.github.io/probes/imgs/seeding/16system.jpg alt="system for n=5"></p><p>The system comes from decomposing the match number $i$ as $i=2^k + l$ where $k = \lfloor \log_2{i} \rfloor$. If we write the even seed as powers of two then they display a binary counting system going up between match numbers that are powers of two. In fact, it&rsquo;s the binary representation of $i-2l$ that is required, so let $c_j = bit_j (i-2l)$. We can then verify the final function (sending match number to the even seed in that match).</p><p>$$2^k + l \mapsto \begin{cases} 2^{n-k},&amp; \text{if $l=0$} \\ 2^{n-k-1}+2^n \sum_{j=1} 2^{-j}c_j,&amp; \text{if $0 &lt; l &lt; 2^k$.}\end{cases}$$</p><h2 id=python-code>Python code</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#ff79c6>def</span> <span style=color:#50fa7b>even_seed_from_match_nr</span>(i, n): <span style=color:#6272a4># match_nr, log2(participants)</span>
    <span style=color:#6272a4>#decompose i = 2^k + r where 0 &lt;= r &lt; 2^k</span>
    k <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>int</span>(math<span style=color:#ff79c6>.</span>floor(math<span style=color:#ff79c6>.</span>log(i,<span style=color:#bd93f9>2</span>)))
    r <span style=color:#ff79c6>=</span> i <span style=color:#ff79c6>-</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> k)

    <span style=color:#ff79c6>if</span> (r <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>): <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> n<span style=color:#ff79c6>-</span>k

    nr <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>bin</span>(i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>2</span><span style=color:#ff79c6>*</span>r)[<span style=color:#bd93f9>2</span>:][::<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>]
    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>int</span>(nr,<span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>&lt;&lt;</span> n<span style=color:#ff79c6>-</span><span style=color:#8be9fd;font-style:italic>len</span>(nr) <span style=color:#ff79c6>|</span> <span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> n<span style=color:#ff79c6>-</span>k<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span></code></pre></div><p>One of the crazier things I have written in python. And as such, it needs a few notes, especially on the non-zero r (denoted as l earlier in doc) case: <code>nr = binary(i-2*r)</code> reversed (remove leading 0b part of string first). Then shift <code>n-k</code> and add in leading term. However, nr should be k bits, so we need to shift more if not (when reversing leading become trailing) so must shift extra <code>len(nr)-k</code> bits. Without the compensation for extra zeroes the return wouldve looked like this: <code>return int(bin(i-2*r)[2:][::-1],2) &lt;&lt; n-k | 1 &lt;&lt; n-k-1</code>. Insane.</p><h2 id=note-from-years-later>Note from years later</h2><p>This provided a part of my open source <a href=https://github.com/clux/duel>duel tournament</a> library.</p><p>The code that deals with this particular bit now looks like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#8be9fd;font-style:italic>var</span> evenSeed <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>function</span> (i, p) {
  <span style=color:#8be9fd;font-style:italic>var</span> k <span style=color:#ff79c6>=</span> <span style=color:#8be9fd;font-style:italic>Math</span>.floor(<span style=color:#8be9fd;font-style:italic>Math</span>.log(i) / Math.log(2))
    , r <span style=color:#ff79c6>=</span> i <span style=color:#ff79c6>-</span> <span style=color:#8be9fd;font-style:italic>Math</span>.pow(<span style=color:#bd93f9>2</span>, k);
  <span style=color:#ff79c6>if</span> (r <span style=color:#ff79c6>===</span> <span style=color:#bd93f9>0</span>) {
    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>Math</span>.pow(<span style=color:#bd93f9>2</span>, p <span style=color:#ff79c6>-</span> k);
  }
  <span style=color:#8be9fd;font-style:italic>var</span> nr <span style=color:#ff79c6>=</span> (i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>2</span><span style=color:#ff79c6>*</span>r).toString(<span style=color:#bd93f9>2</span>).split(<span style=color:#f1fa8c>&#39;&#39;</span>).reverse().join(<span style=color:#f1fa8c>&#39;&#39;</span>);
  <span style=color:#ff79c6>return</span> (<span style=color:#8be9fd;font-style:italic>parseInt</span>(nr, <span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>&lt;&lt;</span> p <span style=color:#ff79c6>-</span> nr.length) <span style=color:#ff79c6>+</span> <span style=color:#8be9fd;font-style:italic>Math</span>.pow(<span style=color:#bd93f9>2</span>, p <span style=color:#ff79c6>-</span> k <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>);
};
</code></pre></div><p>Still and magical and confusing to everyone as ever.</p><p>Clearly, there&rsquo;s probably a more elegant method to be deduced. The method here is just emulating the pattern we see in the binary representation after all. Still, funny what you can do with strings and patterns.</p><div class=blog-tags><a href=https://clux.github.io/probes//tags/math/>math</a>&nbsp;</div><h4 class=see-also>See also</h4><ul><li><a href=https://clux.github.io/probes/post/2006-08-09-vault-of-therayne/>Vault of Therayne</a></li></ul></article><ul class="pager blog-pager"><li class=previous><a href=https://clux.github.io/probes/post/2006-08-09-vault-of-therayne/ data-toggle=tooltip data-placement=top title="Vault of Therayne">&larr; Previous Post</a></li><li class=next><a href=https://clux.github.io/probes/post/2013-03-20-colemak-switchover/ data-toggle=tooltip data-placement=top title="Colemak Switchover">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=mailto:sszynrae@gmail.com title="Email me"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i><i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://github.com/clux title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i><i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/sszynrae title=Twitter><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i><i class="fab fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://reddit.com/u/clux title=Reddit><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i><i class="fab fa-reddit-alien fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://linkedin.com/in/eirik-albrigtsen-b279863a title=LinkedIn><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i><i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://www.youtube.com/channel/UCLpykMxkxuPUR9CciheipZg title=Youtube><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i><i class="fab fa-youtube fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted">clux
&nbsp;&bull;&nbsp;&copy;
2019
&nbsp;&bull;&nbsp;
<a href=https://clux.github.io/probes/>probes</a></p><p class="credits theme-by text-muted"><a href=http://gohugo.io>Hugo v0.52</a> powered &nbsp;&bull;&nbsp; Theme by <a href=http://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a> adapted to <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a></p></div></div></div></footer><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script src=https://clux.github.io/probes/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://clux.github.io/probes/js/load-photoswipe.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous></script><script>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:true},{left:"$",right:"$",display:false},]})</script></body></html>